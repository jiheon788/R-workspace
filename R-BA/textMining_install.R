getwd()
setwd('C:/Users/82104/my-workspace/R-workspace/')
rm(list = ls())
install.packages("stringr")  			# ???Ú¿? Ã³?? ??Å°??
# ?óµµºÐ¼?À» À§?? Package ??Ä¡
install.packages("descr")			# ?óµµºÐ¼? ??Å°??
# ????Å¬?????? ?Ã°?È­?? ?Ê¿? Package ??Ä¡
install.packages("wordcloud") 		# ????Å¬?????? ??Å°??
install.packages("RColorBrewer")  		# ???? ???? ??Å°??

install.packages("remotes")
remotes::install_github("mrchypark/multilinguer",force = T) 

library(multilinguer)
install_jdk() #???? ?ß»??? multilinguer::install_jdk() 
install.packages(c("hash", "tau", "Sejong", "RSQLite", "devtools", "bit", "rex","lazyeval", "htmlwidgets", "crosstalk", "promises", "later", "sessioninfo", "xopen", "bit64", "blob", "DBI", "memoise", "plogr", "covr", "DT", "rcmdcheck", "rversions"), type = "binary") 	

remotes::install_github('haven-jeon/KoNLP', upgrade = "never",INSTALL_opts=c("--no-multiarch"),force = T) 	

# ??Á¦?? ?Ð¼?À» À§?? ??Å°?? ?Ò·??À±?
library("KoNLP") # ?Ñ±? ?Ú¿??? Ã³?? ??Å°??
library(stringr) # ???Ú¿? Ã³?? ??Å°??
library("wordcloud") # ????Å¬?????? ??Å°??
library("RColorBrewer") # ???? ???? ??Å°??
address <- readLines("p2_address.txt") # ?????? ?? ???Î¾? ?Ð¾? ???Ì±?
# ?Ø½?Æ® ?????? Á¤Á¦
address <- address[address != ""] # ???Í³? Null ???? Á¦??
address <- gsub("[[:punct:]]", "", address) # ????Á¡ Á¦??
# ?? ???Î¸??? ???? ?Ü¾??é¸¸ ??????
addNouns <- sapply(address, extractNoun, USE.NAMES=F)
addNounsList <- unlist(addNouns) # ?Ü¾??é¸¸ ??Á®?À±?
addNounsList
# ?Ò¿??? ?Ü¾? Á¦??
stopWord <- c() # ?Ò¿??? ?Ü¾? ????
addNounsList <- addNounsList[! addNounsList%in% stopWord]
# 2???? ?Ì»??? ?Ü¾î¸¸ ???Í¸?
addLastData <- Filter(function(x) {
  nchar(x) >= 2
},addNounsList)
# ??Á¾ 2???? ?Ì»??? ?Ü¾????? ????
addLastData # ?????? ?Ü¾? ????
# ???????? ?Ü¾? ??
length(addLastData)

# ?Ü¾??é¿¡ ???? ?óµµºÐ¼?
library(descr)
freq_table <- freq(addLastData, plot=FALSE) 	# ?óµµºÐ¼?
freq_table <- as.data.frame(freq_table)
freq_table <- freq_table[order(freq_table$Frequency, decreasing = TRUE),]
freq_table 				# ??Á¦?? ????Ç¥
# ????Å¬?????? ?Ã°?È­
ListWordCount = table(addLastData) # ???Ìº? ???? ??È¯?Ø¼? ????
windows()
windowsFonts(font=windowsFont("??Àº ????")) # ??Æ® ??Á¤
# ????Å¬?????? ?Ã°?È­ ?Ô¼? ????
wordcloud( names(ListWordCount), freq=ListWordCount,
           scale=c(5,0.2), # ?Ö´? ????, ?Ö¼? ???? ?Ü¾??? ??Æ® Å©??
           rot.per=0.1, # 90?? È¸???Ø¼? ?????? ?Ü¾? ??À²
           min.freq=1, max.words=100, # ???? 1 ?Ì»?, 100 ?Ì¸?
           random.order=F, # True: ???? ??Ä¡, False: ?Ö´? ???? ?Ü¾î¸¦ ?ß¾? ??Ä¡
           random.color=T, # True: ?? ????, False: ?óµµ¼?
           colors=brewer.pal(11, "Paired"), # 11Àº ?????? ???? ????, ?? ??Â°?? ???? Å¸?? ?Ì¸?
           family="font")
# ?Ø½?Æ®???Ì´?À» À§?? Package ??Ä¡
# ??Æ®??Å© ?Ã°?È­?? ?Ê¿? Package ??Ä¡
install.packages("sna") 			#?×·??? ???? Ã³?? ??Å°??
install.packages("igraph") 			#?×·??? ?Û¼? ??Å°??
# ?Ø½?Æ®???Ì´?À» À§?? tm ??Å°?? ??Ä¡
require(remotes)
install_version("tm", version = "0.7-5")
installed.packages()[,c("Package","Version")] 	# tm ??Å°?? ???? È®??

library(KoNLP) # ?Ñ±? ?Ú¿??? Ã³?? ??Å°??
library(tm) # ?Ø½?Æ®???Ì´? ???? ??Å°??
data <- read.csv("vision.csv", header = T, fileEncoding="EUC-KR") # ???? ???? csv ???? ?Ð±?
text <- as.vector(data$????) # ?????? ?Ð±?
# ?Ø½?Æ® ?Ú·? Á¤Á¦
text <- gsub("[[:punct:]]", "", text) # ????Á¡ Á¦??
text <- gsub("[[:digit:]]", "", text) # ???? Á¦??
TermsList <- sapply(text, extractNoun, USE.NAMES=F) # ???? ?Ü¾? ????

# ???Û½? ?Û¼?
corpus <- Corpus(VectorSource(TermsList)) # ?????é¿¡ ???? ???Û½? ?Û¼?
inspect(corpus)	
# ????-?Ü¾? ????
stopWord <- c("????","???Ï´?","????","????","????") # ?Ò¿??? ??Á¤
dtm <- DocumentTermMatrix(corpus, control=list(corpus, control=list(removePunctuation=TRUE, stopwords=stopWord,removeNumbers=TRUE, wordLengths=c(4, 20), weighting=weightTfIdf)))
inspect(dtm) # ????-?Ü¾? ???? È®??
dtm <- weightTfIdf(dtm)
inspect(dtm) # ?Ü¾? ????-?????? ????(TF-IDF) ????

# ?Ü¾?-???? ???? ?Û¼?
tdm <- TermDocumentMatrix(corpus, control=list(
  removePunctuation=TRUE, stopwords=stopWord,
  removeNumbers=TRUE, wordLengths=c(4, 20), weighting=weightBin))
# ?ß¿? ?Ü¾? ????
tdm.matrix <- as.matrix(tdm) # tdm ???? ????
word.count <- rowSums(tdm.matrix) # ?Ü¾îº° ?óµµ¼? ????
word.order <- order(word.count, decreasing=TRUE) # ?óµµº? ???? ??Á¤
freq.words <- tdm.matrix[word.order[1:30], ] # ?óµµ¼? ??Àº 30?? ?Ü¾? ??Á¤
co.matrix <- freq.words %*% t(freq.words) # ?Ü¾îº° ??Á¢???? ????
co.matrix
# ????-?Ü¾? ?????? ?????? ????
M <- as.matrix(dtm) # ?????? ?????? ????
M
# ??Á¢???? ?Û¼?
g <- cor(M) # ???????? ?Ð¼?
diag(g) <- 0 # ?ë°¢?? ???? 0 ??Á¤
g[g < 0.5 ] <- 0 # ???????? 0.5 ???Ï´? ???? ??Á¦
g # ??Á¢???? ?Û¼?
# ??Æ®??Å© ?×·??? ?Û¼?
library(sna)
gplot(g, label=colnames(g), gmode="graph", label.cex=0.6, vertex.cex=1)

# ???? ?ðµ¨¸?À» À§?? Package ??Ä¡
install.packages("topicmodels")			 # ???? ?ðµ¨¸? ?âº» ??Å°??

# ???? ?ðµ¨¸?À» À§?? ??Å°?? ?Ò·??À±?
library(KoNLP)
library(tm)
library(topicmodels)

# ?Û¾? ???? ??Á¤ ?? ?????? ?Ò·??À±?
data <- read.csv("ck_data.csv", header = T, fileEncoding="EUC-KR") # csv ???? ?Ð±?
text <- as.vector(data$?????Ü¸? )
# ?Ø½?Æ® ?Ú·? Á¤Á¦
text <- gsub("[[:punct:]]", "", text) # ????Á¡ Á¦??
text <- gsub("[[:digit:]]", "", text) # ???? Á¦??
TermsList <- sapply(text, extractNoun, USE.NAMES=F) # ???? ?Ü¾? ????

# ???Û½? ?Û¼?
corpus <- Corpus(VectorSource(TermsList)) # ?????é¿¡ ???? ???Û½? ?Û¼?
inspect(corpus)
# ?Ò¿??? ??Á¤
stopWord <- c()

# ????-?Ü¾? ????
dtm <- DocumentTermMatrix(corpus, control=list(corpus, control=list(
  removePunctuation=TRUE, stopwords=stopWord, 
  removeNumbers=TRUE, wordLengths=c(4, 20)))) 
# ???? ?ðµ¨¸?
lda <- LDA(dtm, k = 3) # k?? ???? ??(3?? ???? ????)
term <- terms(lda, 10) # 10?Ü¾?????
term # ????

# ???? ??À§
top_topics <- apply(posterior(lda)$topics, 1, which.max) # ?????? ???? ??À§
head(data.frame(topic=top_topics), 20)
doc_topic <- cbind(top_topics , text ) # ?????? ????
head(doc_topic) 		

